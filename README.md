# CAlandDet model for Landslide Mapping

## Requestments

To set up the required environment, the 3 steps is need:

1. Check you CUDA vision and install **pytorch** and **torchvision** from [the official website](https://pytorch.org/)；

- PyTorch and torchvision 2.1.0+cu121 is recommended version.

2. Install **GDAL** using conda, please run:

    ```bash
    conda install GDAL==3.6.2
    ```

3. To install other required package, please run:

    ```bash
    pip install -r requirements.txt
    ```


## CAlandDet

The model was originally named ZiHao Net, derived from my friend's name, but this name seemed insufficiently academic and too casual for paper, so it was changed to CAlanDet. However, you might still find traces of the previous name in the code files.

## Baseline dataset
This dataset [(for google drive)](https://drive.google.com/file/d/1YpIN08Ou2w3GJLVgq-Ts7Xf4UV6fGV8v/view?usp=sharing) is based on:<br> 
- [Bijie Landslide Dataset](https://gpcv.whu.edu.cn/data/Bijie_pages.html);<br> 
- [High-precision aerial imagery and interpretation dataset of landslide and debris flow disaster in Sichuan and surrounding areas](https://www.scidb.cn/en/detail?dataSetId=803952485596135424#p2);<br> 
- [The Global Very-High-Resolution Landslide Mapping Dataset](https://github.com/zxk688/GVLM).<br>

We appreciate their selfless contributions to academic research. For more details, please refer to the original articles listed below:<br> 


1. <small><em> Ji, S.; Yu, D.; Shen, C.; Li, W.; Xu, Q. Landslide Detection from an Open Satellite Imagery and Digital Elevation Model Dataset Using Attention Boosted Convolutional Neural Networks. Landslides 2020, 17, 1337–1352.</em></small>
2. <small><em> Zhang, X.; Yu, W.; Pun, M.-O.; Shi, W. Cross-Domain Landslide Mapping from Large-Scale Remote Sensing Images Using Prototype-Guided Domain-Aware Progressive Representation Learning. ISPRS J. Photogramm. Remote Sens. 2023, 197, 1–17.</em></small>
3. <small><em> Zeng, C.; Cao, Z.; Su, F.; Zeng, Z.; Yu, C. A Dataset of High-Precision Aerial Imagery and Interpretation of Landslide and Debris Flow Disaster in Sichuan and Surrounding Areas between 2008 and 2020. China Sci. Data 2022, 7, 195–205.</em></small>

## Large scale image inference tool

tif2mask.py is a small tool I developed for generating predictions on large scale imagery. Its segmentation strategy intentionally discards border regions that lack sufficient context, resulting in more cohesive segmentation results. If you need to process large scale segmentation outputs, this tool may be useful.


## Cite this article
If you find this work useful, please cite our paper: 
```
@article{hu_hierarchical_2025,
	title = {Hierarchical cross attention achieves pixel precise landslide segmentation in submeter optical imagery},
	volume = {15},
	issn = {2045-2322},
	url = {https://doi.org/10.1038/s41598-025-08695-8},
	doi = {10.1038/s41598-025-08695-8},
	abstract = {Accurate landslide segmentation using remote sensing imagery is a critical component of geohazards response systems, particularly in time-sensitive tasks such as post-earthquake landslide damage assessment and emergency resource allocation. However, current methodologies struggle with two persistent challenges in sub-meter true-color imagery: fine-grained inter-class confusion between landslides and spectrally analogous terrain features, and within-landslide heterogeneity where localized damage signatures coexist with macro-scale deformation patterns within individual landslide bodies. To overcome these, we propose the Cross-Attention Landslide Detector ({CALandDet}), which improves the model’s ability to distinguish between landslide and background features by sharply capturing global landslide feature information and integrating global landslide feature information with local information via a cross-attention feature enhancement mechanism. Ablation experiments show that {CALandDet} outperforms baselines, as evidenced by a 4.89\% enhanced F1 score and an 8.73\% greater Intersection over Union ({IoU}). In comparative experiments, it outperforms the other models by 8.05–10.78\% in {IoU} and 1.05–8.9\% in F1 score, achieving an {IoU} of 82.65\% and an F1 score of 81.64\%. Furthermore, the Gradient-weighted Class Activation Mapping (Grad-{CAM}) visualizations confirm that the decision regions generated by the {CALandDet} model exhibit a higher spatial consistency with the actual landslide areas, effectively capturing indicative features including surface textures, sliding debris, accumulation bodies, and vegetation destruction. The proposed method may serve as a reference for future advancements in landslide segmentation and other remote sensing segmentation tasks.},
	pages = {21933},
	number = {1},
	journaltitle = {Scientific Reports},
	shortjournal = {Scientific Reports},
	author = {Hu, Wenjie and Sun, Guangtong and Zeng, Xiangqiang and Tong, Bo and Wang, Zihao and Wu, Xinyue and Song, Ping},
	date = {2025-07-01},
}
```
